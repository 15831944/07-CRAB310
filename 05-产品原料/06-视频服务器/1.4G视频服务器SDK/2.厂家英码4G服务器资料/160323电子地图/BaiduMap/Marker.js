var markerMap=new Map();var tailKey=null;function createMarker(f){try{if(markerMap.containsKey(f.Key)){baiduMapException(2112,null,f.Key);return null}var l=new BMap.Point(f.PointX,f.PointY);var b=(f.Title==null)?null:f.Title;var a=(f.Label==null)?null:f.Label;var k=(f.Info==null)?null:f.Info;var j=null;if(f.Icon!=null){if(f.Icon.DefaultIcon!=null){j=getDefaultIcon(f.Icon.DefaultIcon)}else{if(f.Icon.ImageUrl!=null&&f.Icon.ImageUrl!=""){j=createIcon(f.Icon)}}}var g=new BMap.Marker(l,{title:f.Title,icon:j});if(a!=null){g.setLabel(new BMap.Label(a,{offset:new BMap.Size(DEFAULT_LABEL_OFFSETX,DEFAULT_LABEL_OFFSETY)}))}g.addEventListener("click",onMarkerClick);g.addEventListener("dblclick",onMarkerDbClick);var m=new BMap.ContextMenu();var c=[{text:"播放视频",callback:function(p,o,n){window.external.JsPlayVideo(markerMap.getKey(n))}}];for(var d=0;d<c.length;d++){m.addItem(new BMap.MenuItem(c[d].text,c[d].callback),100)}g.addContextMenu(m);g.mtitle=b;g.minfo=k;markerMap.put(f.Key,g);return g}catch(h){baiduMapException(2211,h,f.Key);return null}return null}function initMarkerAndshown(jsonstr){try{objs=eval("("+jsonstr+")")}catch(e){if(e instanceof SyntaxError){baiduMapException(2111,e,jsonstr)}return}for(i=0;i<objs.length;i++){obj=objs[i];var marker=createMarker(obj);if(marker!=null){map.addOverlay(marker)}}}function deleteMarker(keys){var list=eval(keys);for(i=0;i<list.length;i++){var marker=markerMap.remove(list[i]);map.removeOverlay(marker)}}function deleteAllMarker(){for(i=0;i<markerMap.size();i++){var a=markerMap.element(i).value;if(a.getMap()!=null){map.removeOverlay(a)}}markerMap.clear()}function updateMarkerWithoutInit(l,f,e,d,c,j){var b=markerMap.get(l);if(b==null){baiduMapException(2122,null,l);return false}else{var k=b.getPosition();(f==null)?null:(k.lng=f);(e==null)?null:(k.lat=e);b.setPosition(k);if(l==tailKey){pointMarker(l)}if(d!=null){b.setTitle(d);b.mtitle=d}if(c!=null){var h=b.getLabel();if(c==""){b.setLabel(null)}if(h!=null){h.setContent(c)}else{b.setLabel(new BMap.Label(c,{offset:new BMap.Size(DEFAULT_LABEL_OFFSETX,DEFAULT_LABEL_OFFSETY)}))}}if(j!=null){b.minfo=j;if(mInfoWindow.marker==b){var a=b.minfo;var g=b.mtitle;if(a==null||a==""){a=DEFAULT_INFOWINDOW_NULLINFO}if(g==null){g=""}mInfoWindow.setTitle(g);mInfoWindow.setContent(a)}}return true}}function updateMarker(jsonstr){try{var objs=eval("("+jsonstr+")")}catch(e){baiduMapException(2121,e,jsonstr);return false}for(i=0;i<objs.length;i++){var obj=objs[i];var marker=markerMap.get(obj.Key);if(marker==null){marker=createMarker(obj);map.addOverlay(marker)}else{var point=marker.getPosition();(obj.PointX==null)?null:(point.lng=obj.PointX);(obj.PointY==null)?null:(point.lat=obj.PointY);marker.setPosition(point);if(obj.Key==tailKey){pointMarker(obj.Key)}if(obj.Title!=null){marker.setTitle(obj.Title);marker.mtitle=obj.Title}if(obj.Label!=null){var label=marker.getLabel();if(obj.Label==""){marker.setLabel(null)}if(label!=null){label.setContent(obj.Label);marker.setLabel(label)}else{marker.setLabel(new BMap.Label(obj.Label,{offset:new BMap.Size(DEFAULT_LABEL_OFFSETX,DEFAULT_LABEL_OFFSETY)}))}}if(obj.Info!=null){marker.minfo=obj.Info;if(mInfoWindow.marker==marker){var info=marker.minfo;var title=marker.mtitle;if(info==null||info==""){info=DEFAULT_INFOWINDOW_NULLINFO}if(title==null){title=""}mInfoWindow.setTitle(title);mInfoWindow.setContent(info)}}var icon=null;if(obj.Icon!=null){if(obj.Icon.DefaultIcon!=null){icon=getDefaultIcon(obj.Icon.DefaultIcon)}else{if(obj.Icon.ImageUrl!=null&&obj.Icon.ImageUrl!=""){icon=createIcon(obj.Icon)}}}marker.setIcon(icon)}}}function getMarkerKeys(){var a=markerMap.keys();return a.toString()}function isMarkerExist(a){return markerMap.containsKey(a)}function getMarkerKeysOnShown(){var c=new Array();var b=0;for(i=0;i<markerMap.size();i++){var a=markerMap.element(i).value;if(a.getMap()!=null){if(a.isVisible()){c[b++]=markerMap.element(i).key}}}return c.toString()}function deleteMarkersNotShown(){for(i=0;i<markerMap.size();i++){var a=markerMap.element(i).value;if(a.getMap()==null){markerMap.removebyindex(i);continue}if(!a.isVisibel()){map.removeOverlay(a);markerMap.removebyindex(i)}}}function showMarkers(keys){var list=eval(keys);for(i=0;i<list.length;i++){var marker=markerMap.get(list[i]);if(marker!=null){if(marker.getMap==null){map.addOverlay(marker)}if(!marker.isVisible()){marker.show()}}else{baiduMapException(2131,null,list[i])}}}function hiddenMarkers(keys){var list=eval(keys);for(i=0;i<list.length;i++){var marker=markerMap.get(list[i]);if(marker!=null){marker.hide()}else{baiduMapException(2132,null,list[i])}}}function showAllMarkers(){for(i=0;i<markerMap.size();i++){var a=markerMap.element(i).value;if(a!=null){if(a.getMap==null){map.addOverlay(a)}if(!a.isVisible()){a.show()}}}}function hiddenAllMarkers(){for(i=0;i<markerMap.size();i++){var a=markerMap.element(i).value;if(a!=null){a.hide()}}}function pointMarker(c){var b=markerMap.get(c);if(b==null){baiduMapException(2133,null,c);return false}if(b.getMap()==null){baiduMapException(2134,null,c);
return false}if(!b.isVisible()){baiduMapException(2134,null,c);return false}var a=b.getPosition();map.panTo(a);return true}function isMarkerVisible(b){var a=markerMap.get(b);if(a==null){return false}if(a.getMap()==null){return false}if(a.isVisible()){return true}return false}function getMarkerpoint(d){var c=markerMap.get(d);if(c==null){return false}var b=c.getPosition();var a=String(b.lng+","+b.lat);return a}function getMarkerTitle(b){var a=markerMap.get(b);if(a==null){return""}if(a.mtitle!=null){return a.mtitle}return""}function getMarkerLabel(b){var a=markerMap.get(b);if(a==null){return""}if(a.getLabel()!=null){return a.getLabel().content}return""}function getMarkerInfo(b){var a=markerMap.get(b);if(a==null){return""}if(a.minfo!=null){return a.minfo}return""}function showMarkerLabel(keys){var list=eval(keys);for(i=0;i<list.length;i++){var marker=markerMap.get(list[i]);if(marker!=null){var label=marker.getLabel();if(label!=null){label.show()}}}}function hiddenMarkerLabel(keys){var list=eval(keys);for(i=0;i<list.length;i++){var marker=markerMap.get(list[i]);if(marker!=null){if(marker.isVisible()){var label=marker.getLabel();if(label!=null){label.hide()}}}}}function showAllMarkerLabel(){for(i=0;i<markerMap.size();i++){var a=markerMap.element(i).value;if(a.getMap()!=null){var b=a.getLabel();if(b!=null){b.show()}}}}function hiddenAllMarkerLabel(){for(i=0;i<markerMap.size();i++){var a=markerMap.element(i).value;if(a.getMap()!=null){if(a.isVisible()){var b=a.getLabel();if(b!=null){b.hide()}}}}}function updateMarkerIcon(key,jsonstr){try{var obj=eval("("+jsonstr+")")}catch(e){return false}var marker=markerMap.get(key);if(marker==null){return false}else{marker.setIcon(createIcon(obj.Icon));return true}return false}function updateMakerWithDefaultIcon(c,b){var a=markerMap.get(c);if(a==null){return false}else{a.setIcon(getDefaultIcon(b));return true}return false}function openMarkerInfoWindow(b){var a=markerMap.get(b);if(a==null){return}else{var c=a.minfo;var d=a.mtitle;if(c==null||c==""){c=DEFAULT_INFOWINDOW_NULLINFO}if(d==null){d=""}mInfoWindow.setTitle(d);mInfoWindow.setContent(c);a.openInfoWindow(mInfoWindow);mInfoWindow.marker=a}}function closeInfoWindow(){mInfoWindow.hide()}function tailMarker(a){if(a==null||a==""){tailKey="";return true}if(a==tailKey){return true}if(!markerMap.containsKey(a)){baiduMapException(2135,null,a);return false}tailKey=a;pointMarker(a);return true}function getTailMarker(){return tailKey}function onMarkerMouseOver(a){}function onMarkerClick(b){var a=b.target.minfo;var c=b.target.mtitle;if(a==null||a==""){a=DEFAULT_INFOWINDOW_NULLINFO}if(c==null){c=""}mInfoWindow.setTitle(c);mInfoWindow.setContent(a);b.target.openInfoWindow(mInfoWindow);mInfoWindow.marker=b.target}function onMarkerRightClick(a){alert(a.target)}function onMarkerDbClick(a){if(DEFAULT_MARKER_DBCLICK_ZOOM!=0){if(map.getZoom()<DEFAULT_MARKER_DBCLICK_ZOOM){map.setZoom(DEFAULT_MARKER_DBCLICK_ZOOM)}else{map.setZoom(map.getZoom()+1)}map.panTo(a.target.getPosition())}};