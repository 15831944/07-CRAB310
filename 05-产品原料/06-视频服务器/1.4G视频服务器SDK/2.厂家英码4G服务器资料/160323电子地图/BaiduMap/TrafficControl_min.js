var BMapLib=window.BMapLib=BMapLib||{};
(function(){function s(b,a,c){var e;b.insertAdjacentHTML?b.insertAdjacentHTML(a,c):(e=b.ownerDocument.createRange(),a=a.toUpperCase(),"AFTERBEGIN"==a||"BEFOREEND"==a?(e.selectNodeContents(b),e.collapse("AFTERBEGIN"==a)):(a="BEFOREBEGIN"==a,e[a?"setStartBefore":"setEndAfter"](b),e.collapse(a)),e.insertNode(e.createContextualFragment(c)));return b}function t(a,d){var c=document.createElement("script");c.setAttribute("src",a);c.setAttribute("type","text/javascript");c.setAttribute("charset","gbk");c.addEventListener?
c.addEventListener("load",function(a){a=a.target;a.parentNode.removeChild(a);d&&d()},!1):c.attachEvent&&c.attachEvent("onreadystatechange",function(a){!(a=window.event.srcElement)||"loaded"!=a.readyState&&"complete"!=a.readyState||(a.parentNode.removeChild(a),d&&d())});setTimeout(function(){document.getElementsByTagName("head")[0].appendChild(c);c=null},1)}var a=a||{version:"1.3.9"};a.guid="$BAIDU$";(function(){a.dom=a.dom||{};a.event=a.event||{};a.lang=a.lang||{};a.browser=a.browser||{};a.dom.addClass=
function(b,d){b=a.dom.g(b);for(var c=d.split(/\s+/),e=b.className,h=" "+e+" ",k=0,g=c.length;k<g;k++)0>h.indexOf(" "+c[k]+" ")&&(e+=(e?" ":"")+c[k]);b.className=e;return b};a.addClass=a.dom.addClass;a.dom.removeClass=function(b,d){b=a.dom.g(b);for(var c=b.className.split(/\s+/),e=d.split(/\s+/),h,k=e.length,g,l=0;l<k;++l)for(g=0,h=c.length;g<h;++g)if(c[g]==e[l]){c.splice(g,1);break}b.className=c.join(" ");return b};a.removeClass=a.dom.removeClass;a.dom.getComputedStyle=function(b,d){b=a.dom._g(b);
var c=a.dom.getDocument(b);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(b,null))?c[d]||c.getPropertyValue(d):""};a.dom.getStyle=function(b,d){var c=a.dom;b=c.g(b);return b.style[d]||(b.currentStyle?b.currentStyle[d]:"")||c.getComputedStyle(b,d)};a.getStyle=a.dom.getStyle;a.dom.getDocument=function(b){b=a.dom.g(b);return 9==b.nodeType?b:b.ownerDocument||b.document};a.dom.g=function(a){return"string"==typeof a||a instanceof String?document.getElementById(a):
a&&a.nodeName&&(1==a.nodeType||9==a.nodeType)?a:null};a.g=a.G=a.dom.g;a.dom._g=function(b){return a.lang.isString(b)?document.getElementById(b):b};a._g=a.dom._g;a.lang.isString=function(a){return"[object String]"==Object.prototype.toString.call(a)};a.isString=a.lang.isString;a.event._listeners=a.event._listeners||[];a.event.on=function(b,d,c){d=d.replace(/^on/i,"");b=a.dom._g(b);var e=function(a){c.call(b,a)},h=a.event._listeners,k=a.event._eventFilter,g=d;d=d.toLowerCase();k&&k[d]&&(e=k[d](b,d,e),
g=e.type,e=e.listener);b.addEventListener?b.addEventListener(g,e,!1):b.attachEvent&&b.attachEvent("on"+g,e);h[h.length]=[b,d,c,e,g];return b};a.on=a.event.on;a.event.un=function(b,d,c){b=a.dom._g(b);d=d.replace(/^on/i,"").toLowerCase();for(var e=a.event._listeners,h=e.length,k=!c,g,l;h--;)g=e[h],g[1]!==d||g[0]!==b||!k&&g[2]!==c||(l=g[4],g=g[3],b.removeEventListener?b.removeEventListener(l,g,!1):b.detachEvent&&b.detachEvent("on"+l,g),e.splice(h,1));return b};a.un=a.event.un;/msie (\d+\.\d)/i.test(navigator.userAgent)&&
(a.browser.ie=a.ie=document.documentMode||+RegExp.$1);a.platform=a.platform||{};a.platform.isIphone=/iphone/i.test(navigator.userAgent);a.platform.isAndroid=/android/i.test(navigator.userAgent);a.platform.isIpad=/ipad/i.test(navigator.userAgent);a.isMobile=function(){return!!(a.platform.isIphone||a.platform.isIpad||a.platform.isAndroid)}})();var p=a.isMobile()?"_mobile":"_deskTop",n=BMapLib.TrafficControl=function(a){this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT;this.defaultOffset=new BMap.Size(10,10);
this.showPanel=a&&a.showPanel};n.prototype=new BMap.Control;n.prototype.initialize=function(b){var d={title:"\u663e\u793a\u4ea4\u901a\u6d41\u91cf",id:"tcBtn","class":"maplibTcBtn"+p+" maplibTcBtnOff"+p},c=document.createElement("div"),d=d||{},e;for(e in d){value=d[e];var h={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign"};8>a.browser.ie?(h["for"]="htmlFor",h["class"]="className"):(h.htmlFor="for",h.className="class");e=h[e]||e;if("style"==e)c.style.cssText=
value;else if(c.setAttribute)c.setAttribute(e,value);else try{c[e]=value}catch(k){}}b.getContainer().appendChild(c);this._map=b;this._popUpDiv(this,c);return this.btn=c};n.prototype._popUpDiv=function(b,d){function c(){f.isbShow()?(b.hideTraffic(),f.hide(),d.style.backgroundPosition="0 -249px",this.bShow=!1):(f.setPopOffset(b.getOffset()),f.show(),d.style.backgroundPosition="0 -271px",this.bShow=!0)}function e(){function c(){var a=n.curTime,d=a.getHours();f._bind||(h(b),k(b),f._bind=!0);var e=(10>
d?"0"+d:d)+":"+(10>a.getMinutes()?"0"+a.getMinutes():a.getMinutes());r.innerHTML=e;b.hour=d;b.weekday=0==a.getDay()?7:a.getDay();b.time=e;v.setBarTime(d)}u.innerHTML="\u66f4\u65b0\u65f6\u95f4";w.innerHTML=g[1];a.dom.addClass(x,"maplibTcHide");y.style.display="block";l=!0;a.isMobile()?b.showPanel&&a.dom.removeClass("tcWrap_mobile","maplibTfctrHide"):a.dom.removeClass("tcWrap","maplibTcHide");for(var d=a.g("tcWeek").getElementsByTagName("a"),e=0;7>e;e++)d[e].className="";if(f.isjShow()&&f.isjIn()||
!f.isbShow())t("http://its.map.baidu.com:8002/traffic/GetCurrentTime?callback=BMapLib.TrafficControl.getTime&"+(new Date).getTime(),c),b.timer&&clearInterval(b.timer),b.timer=setInterval(function(){t("http://its.map.baidu.com:8002/traffic/GetCurrentTime?callback=BMapLib.TrafficControl.getTime&"+(new Date).getTime(),function(){var a=n.curTime,d=a.getHours(),a=(10>d?"0"+d:d)+":"+(10>a.getMinutes()?"0"+a.getMinutes():a.getMinutes());r.innerHTML=a;b.hideTraffic();b.showTraffic()})},18E4)}function h(b){a.event.on("tcUpdate",
"click",function(){e()})}function k(d){a.event.on("tcWeek","onclick",function(c){c=c.target||c.srcElement;if("a"==c.tagName.toLowerCase()){for(var e=a.g("tcWeek").getElementsByTagName("a"),f=0;7>f;f++)e[f].className="";a.dom.addClass(c,"maplibTcOn");e=parseInt;(f="lang")&&f.constructor==String?(f={"for":"htmlFor","class":"className"}[f]||f,c=c[f]||c.getAttribute(f)||""):c="";d.weekday=e(c,10);u.innerHTML="\u661f\u671f"+z[b.weekday-1];r.innerHTML=q.innerHTML;d.showTraffic({predictDate:{hour:d.hour,
weekday:d.weekday}})}})}b=this;var g=["\u67e5\u770b\u6d41\u91cf\u9884\u6d4b","\u5b9e\u65f6\u8def\u51b5"],l=!0;this.bShow=!1;var f=this;this.jIn=this.jShow=f._bind=!1;s(d,"afterEnd",function(){var a=['<div class="maplibTc maplibTcHide" id="tcWrap">'];a.push('<div class="maplibTcColor" id="tcTitle">\u5b9e\u65f6\u8def\u51b5</div>');a.push('<div id="tcRealTime">');a.push('<div class="maplibTcTime"><span id="maplibTcDay" class="maplibTcCurTime">\u66f4\u65b0\u65f6\u95f4</span><span><span class="maplibTcColon">\uff1a&nbsp;</span><span class="maplibTcCurTime" id="tcNow"></span><span title="\u66f4\u65b0" id="tcUpdate" class="maplibTcUpdate"></span> <a href="javascript:void(0)" class="maplibTcView" id="tcViewPrediction"></a><button class="maplibTcClose" id="tcClose"></button></div></div>');
a.push('<div id="tcPredition" class="maplibTcHide">');a.push('<div class="maplibTcWeekDay"><span>\u661f\u671f</span><ul id="tcWeek"><li><a lang="1" href="javascript:void(0)">\u4e00</a></li><li><a lang="2" href="javascript:void(0)">\u4e8c</a></li><li><a lang="3" href="javascript:void(0)">\u4e09</a></li><li><a lang="4" href="javascript:void(0)">\u56db</a></li><li><a lang="5" href="javascript:void(0)">\u4e94</a></li><li><a lang="6" href="javascript:void(0)">\u516d</a></li><li><a lang="7" href="javascript:void(0)">\u65e5</a></li></ul></div>');
a.push('<div><div class="maplibTcRuleTxt">\u65f6\u95f4</div>');a.push('<div class="maplibTcRule">');a.push('<div><div class="maplibTcTimeBox" id="tcTimeBox">20:00</div></div>');a.push('<div class="maplibTcTimeline" >');a.push('<div class="maplibTcTimelinePrev" id="tcPrev"></div>');a.push('<div class="maplibTcTimeMove" id="tcMove"></div>');a.push('<div class="maplibTcTimelineNext" id="tcNext"></div>');a.push("</div></div></div>");a.push('<div class="maplibTcClear" style="text-align: center; color: #ccc;">\uff08\u57fa\u4e8e\u5386\u53f2\u6d41\u91cf\u7edf\u8ba1\u9884\u6d4b \u4ec5\u4f9b\u53c2\u8003\uff09</div>');
a.push("</div></div></div>");return a.join("")}());s(d,"afterEnd",'<div class="maplibTfctr maplibTfctrHide" id="tcWrap_mobile" style="position: absolute; z-index: 10; -webkit-text-size-adjust: none; bottom: 17px; right: auto; top: auto; left:50%;margin-left:-4.5em;"><div class="maplibTfctr_l"></div><div class="maplibTfctr_c">\u5b9e\u65f6\u8def\u51b5</div><div class="maplibTfctr_status"><span class="maplibR">\u5835</span><span class="maplibY">\u7f13</span><span class="maplibG">\u7545</span></div></div>');
var x=a.g("tcPredition"),w=a.g("tcTitle"),u=a.g("maplibTcDay"),r=a.g("tcNow"),m=a.g("tcWrap"),q=a.g("tcTimeBox"),y=a.g("tcUpdate"),z="\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u65e5".split(""),v=new function(b){function d(b){b=b.clientX||b.x;for(var c=a.G("tcPrev"),e=0;c&&c.offsetParent;)e+=c.offsetLeft,c=c.offsetParent;b=b-(e+9)-4;0>b&&(b=0);165<b&&(b=165);k.style.marginLeft=6>=a.browser.ie?0.53*b+"px":b+"px";q.style.marginLeft=b+"px";g()}function c(){a.un(document,"onmousemove",d);a.un(document,"onmouseup",
c);b.showTraffic({predictDate:{hour:b.hour,weekday:b.weekday}})}function e(b){var c=parseInt(a.dom.getStyle("tcTimeBox","marginLeft")),c=Math.ceil(24*(c-4)/165);f("next"==b?c+1:c-1)}function f(c){0>c&&(c=0);24<c&&(c=24);h=c;c*=6.875;q.style.marginLeft=c+"px";a.g("tcMove").style.marginLeft=6>=a.browser.ie&&0<a.browser.ie?0.53*c+"px":c+"px";b.hour=h;l?b.showTraffic():b.showTraffic({predictDate:{hour:b.hour,weekday:b.weekday}});g()}function g(){var a=parseInt(q.style.marginLeft);h=a=Math.ceil(24*(a-
4)/165);b.hour=a;10>a&&(a="0"+a);l?(r.innerHTML=b.time,q.innerHTML=a+":00"):r.innerHTML=q.innerHTML=a+":00"}var h,k=a.g("tcMove");a.on(k,"onmousedown",function(b){a.on(document,"onmousemove",d);a.on(document,"onmouseup",c);b&&b.preventDefault?b.preventDefault():window.event.returnValue=!1;return!1});a.on("tcPrev","click",function(){e("prev")});a.on("tcNext","click",function(){e("next")});this.setBarTime=function(a){f(a)}}(b);this.show=function(){e();b.jShow=!0;a.dom.removeClass(d,"maplibTcBtnOff"+
p)};this.hide=function(){b.jShow=!1;a.dom.addClass(d,"maplibTcBtnOff"+p);a.isMobile()?a.dom.addClass("tcWrap_mobile","maplibTfctrHide"):(a.dom.addClass("tcWrap","maplibTcHide"),a.dom.addClass("tcPredition","maplibTcHide"))};this.isbShow=function(){return b.bShow};this.isjShow=function(){return b.jShow};this.isjIn=function(){return b.jIn};this.setPopOffset=function(a){var c=a.height+24+"px";a=a.width+"px";switch(b.getAnchor()){case BMAP_ANCHOR_TOP_LEFT:m.style.top=c;m.style.left=a;break;case BMAP_ANCHOR_TOP_RIGHT:m.style.top=
c;m.style.right=a;break;case BMAP_ANCHOR_BOTTOM_RIGHT:m.style.bottom=c;m.style.right=a;break;case BMAP_ANCHOR_BOTTOM_LEFT:m.style.bottom=c,m.style.left=a}};var A=a.isMobile()?"ontouchend":"onclick";a.event.on(d,A,function(){c()});a.event.on("tcClose","click",function(a){f.isjShow()?f.hide():(f.setPopOffset(b.getOffset()),f.show())});a.event.on(d,"onmouseover",function(){f.isbShow()&&(f.setPopOffset(b.getOffset()),f.show(),f.jIn=!0)});a.event.on(d,"onmouseout",function(){f.jIn=!1;f.isbShow()&&setTimeout(function(){f.isjIn()||
(f.hide(),f.jIn=!1)},1E3)});a.event.on(m,"onmouseover",function(){f.isbShow()&&(f.jIn=!0)});a.event.on(m,"onmouseout",function(){f.jIn=!1;setTimeout(function(){f.isjIn()||(f.hide(),f.jIn=!1)},500)})};n.prototype.showTraffic=function(b){this._trafficLayer&&this._map.removeTileLayer(this._trafficLayer);if(b){if(7<b.predictDate.weekday||1>b.predictDate.weekday)return;b=new BMap.TrafficLayer(b)}else b=new BMap.TrafficLayer;this.bShow=!0;a.isMobile()&&a.dom.removeClass(this.btn,"maplibTcBtnOff"+p);this._map.addTileLayer(b);
this._trafficLayer=b};n.prototype.hideTraffic=function(){this.bShow=!1;this._trafficLayer&&(this._map.removeTileLayer(this._trafficLayer),this._trafficLayer=null);a.isMobile()&&a.dom.addClass(this.btn,"maplibTcBtnOff"+p)};n.prototype.remove=function(){this.hideTraffic();var b=a.g("tcWrap");b.parentNode.removeChild(b);BMap.Control.prototype.remove.call(this);this.timer&&clearInterval(this.timer)};n.getTime=function(a){this.curTime=isNaN(a)?new Date:new Date(a)}})();